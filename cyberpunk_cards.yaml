# Cyberpunk Deck Builder - Card Component DSL
# This YAML defines the relationship between card text and component mechanics

# Component Types
components:
  targeting:
    - name: SingleEntityTarget
      description: "Targets a single entity (player, opponent, threat, card)"
      parameters:
        - targetType: "The type of entity to target"
        - allowTargetSelection: "Whether to allow manual selection or auto-select"
        - filter: "Optional function to filter valid targets"
      
    - name: MultiEntityTarget
      description: "Targets multiple entities at once"
      parameters:
        - targetType: "The type of entities to target"
        - maxTargets: "Maximum number of targets"
        - filter: "Optional filter function"
      
    - name: SelfTarget
      description: "Targets the player who played the card"
      parameters: []
      
  cost:
    - name: CreditCost
      description: "Requires a credit payment to play"
      parameters:
        - amount: "Number of credits required"
      
    - name: ActionCost
      description: "Requires action points to play"
      parameters:
        - amount: "Number of actions required"
      
    - name: KeywordRequirement
      description: "Requires cards with specific keywords in play/hand/discard"
      parameters:
        - keyword: "Required keyword"
        - count: "Number of cards with the keyword required"
        - location: "Where to look for cards (play, hand, discard)"
      
  effect:
    - name: GainCredits
      description: "Gives credits to target"
      parameters:
        - amount: "Credits to give"
      
    - name: DealDamage
      description: "Deals damage to target"
      parameters:
        - amount: "Damage amount"
      
    - name: PreventDamage
      description: "Protects target from damage"
      parameters:
        - amount: "Damage to prevent"
      
    - name: DrawCards
      description: "Target draws cards"
      parameters:
        - amount: "Cards to draw"
      
    - name: DiscardCards
      description: "Forces target to discard cards"
      parameters:
        - amount: "Cards to discard"
        - random: "Whether discard is random"
      
    - name: GainAction
      description: "Gives action points to target"
      parameters:
        - amount: "Actions to give"
      
  conditional:
    - name: KeywordSynergy
      description: "Enhances an effect if a card with keyword is in play"
      parameters:
        - keyword: "Keyword to check for"
        - targetComponent: "Component to enhance"
        - bonusAmount: "Amount to increase effect by"
      
  control:
    - name: PauseQueue
      description: "Pauses execution for targeting or other input"
      parameters:
        - message: "Message to display"
      
    - name: CancelCard
      description: "Cancels another card in the queue"
      parameters:
        - targetCardIndex: "Index of card to cancel (optional)"
        - targetCardCondition: "Condition to select card (optional)"
      
  information:
    - name: RevealCard
      description: "Reveals a face-down card"
      parameters: []
      
    - name: ScanEntity
      description: "Reveals information about target"
      parameters:
        - revealFullInfo: "Whether to show all info or just basics"

# Card Translations - Mapping card text to components
card_translations:
  - text: "Gain {X} credit"
    components:
      - type: SelfTarget
      - type: GainCredits
        params:
          amount: "{X}"
    examples:
      - "Gain 1 credit"
      - "Gain 2 credits"
      - "Gain 3 credits"
  
  - text: "Deal {X} damage to opponent"
    components:
      - type: SingleEntityTarget
        params:
          targetType: "opponent"
          allowTargetSelection: false
      - type: DealDamage
        params:
          amount: "{X}"
    examples:
      - "Deal 2 damage to opponent"
      - "Deal 3 damage to opponent"
  
  - text: "Deal {X} damage to a threat"
    components:
      - type: PauseQueue
        params:
          message: "Select a target for damage"
      - type: SingleEntityTarget
        params:
          targetType: "threat"
          allowTargetSelection: true
      - type: DealDamage
        params:
          amount: "{X}"
    examples:
      - "Deal 2 damage to a threat"
      - "Deal 3 damage to a threat"
  
  - text: "Draw {X} card"
    components:
      - type: SelfTarget
      - type: DrawCards
        params:
          amount: "{X}"
    examples:
      - "Draw a card"
      - "Draw 2 cards"
      - "Draw 3 cards"
  
  - text: "Opponent discards {X} card"
    components:
      - type: SingleEntityTarget
        params:
          targetType: "opponent"
          allowTargetSelection: false
      - type: DiscardCards
        params:
          amount: "{X}"
          random: true
    examples:
      - "Opponent discards a card"
      - "Opponent discards 2 cards"
  
  - text: "Prevent {X} damage"
    components:
      - type: SelfTarget
      - type: PreventDamage
        params:
          amount: "{X}"
    examples:
      - "Prevent 2 damage"
      - "Prevent 3 damage"
  
  - text: "Gain {X} action"
    components:
      - type: SelfTarget
      - type: GainAction
        params:
          amount: "{X}"
    examples:
      - "Gain 1 action"
      - "Gain 2 actions"
  
  - text: "If you have another {Keyword} in play, {effect}"
    components:
      - type: KeywordSynergy
        params:
          keyword: "{Keyword}"
          targetComponent: "{derived from effect}"
          bonusAmount: "{derived from effect}"
    examples:
      - "If you have another Virus in play, deal 1 more damage"
      - "If you have another ICE in play, prevent 1 more damage"
  
  - text: "Cancel a card with {Keyword}"
    components:
      - type: CancelCard
        params:
          targetCardCondition: "card => card.keywords.includes('{Keyword}')"
    examples:
      - "Cancel a card with ICE keyword"
      - "Cancel a card with Virus keyword"

# Cards and Their Component Implementations
cards:
  - id: credit_chip
    name: Credit Chip
    text: "Gain 1 credit."
    components:
      - type: SelfTarget
      - type: ActionCost
        params:
          amount: 1
      - type: GainCredits
        params:
          amount: 1
  
  - id: crypto_wallet
    name: Crypto Wallet
    text: "Gain 2 credits."
    components:
      - type: SelfTarget
      - type: ActionCost
        params:
          amount: 1
      - type: GainCredits
        params:
          amount: 2
  
  - id: dark_market
    name: Dark Market
    text: "Gain 1 credit, draw 1 card, and gain 1 action."
    components:
      - type: SelfTarget
      - type: ActionCost
        params:
          amount: 1
      - type: GainCredits
        params:
          amount: 1
      - type: DrawCards
        params:
          amount: 1
      - type: GainAction
        params:
          amount: 1
  
  - id: malicious_code
    name: Malicious Code
    text: "Deal 2 damage to opponent. If you have another Virus program in play, deal 3 damage instead."
    components:
      - type: CreditCost
        params:
          amount: 5
      - type: ActionCost
        params:
          amount: 1
      - type: PauseQueue
        params:
          message: "Select a target for Malicious Code"
      - type: SingleEntityTarget
        params:
          targetType: "threat"
          allowTargetSelection: true
      - type: DealDamage
        params:
          amount: 2
      - type: KeywordSynergy
        params:
          keyword: "Virus"
          targetComponent: "DealDamage"
          bonusAmount: 1
  
  - id: data_breach
    name: Data Breach
    text: "Draw 2 cards. Opponent discards 1 card. If you have another Stealth card in play, opponent discards 2 cards."
    components:
      - type: SelfTarget
      - type: ActionCost
        params:
          amount: 1
      - type: DrawCards
        params:
          amount: 2
      - type: SingleEntityTarget
        params:
          targetType: "opponent"
          allowTargetSelection: false
      - type: DiscardCards
        params:
          amount: 1
          random: true
      - type: KeywordSynergy
        params:
          keyword: "Stealth"
          targetComponent: "DiscardCards"
          bonusAmount: 1
  
  - id: firewall
    name: Firewall
    text: "Prevent the next 2 damage you would take. If you have another ICE in play, prevent 3 damage instead."
    components:
      - type: CreditCost
        params:
          amount: 3
      - type: ActionCost
        params:
          amount: 1
      - type: SelfTarget
      - type: PreventDamage
        params:
          amount: 2
      - type: KeywordSynergy
        params:
          keyword: "ICE"
          targetComponent: "PreventDamage"
          bonusAmount: 1
  
  - id: system_purge
    name: System Purge
    text: "Draw 1 card, trash 1 card from your hand, and gain 1 action."
    components:
      - type: SelfTarget
      - type: ActionCost
        params:
          amount: 1
      - type: DrawCards
        params:
          amount: 1
      - type: DiscardCards
        params:
          amount: 1
          random: false
      - type: GainAction
        params:
          amount: 1
  
  - id: neural_implant
    name: Neural Implant
    text: "Draw 3 cards. You may copy a card from the discard pile if you have another Cyberware in play."
    components:
      - type: SelfTarget
      - type: ActionCost
        params:
          amount: 1
      - type: DrawCards
        params:
          amount: 3
      # Custom component for copying from discard - needs implementation
      - type: KeywordSynergy
        params:
          keyword: "Cyberware"
          targetComponent: "CopyCard" # This would need custom implementation
          bonusAmount: 1
  
  - id: backdoor
    name: Backdoor
    text: "Bypass one ICE card. Draw a card."
    components:
      - type: ActionCost
        params:
          amount: 1
      # Custom component for bypassing ICE - needs implementation
      - type: SelfTarget
      - type: DrawCards
        params:
          amount: 1
  
  - id: trace_program
    name: Trace Program
    text: "Trace a runner program. Opponent discards 1 card."
    components:
      - type: ActionCost
        params:
          amount: 1
      # Custom component for tracing - needs implementation
      - type: SingleEntityTarget
        params:
          targetType: "opponent"
          allowTargetSelection: false
      - type: DiscardCards
        params:
          amount: 1
          random: true

# Keyword Relationships and Synergies
keywords:
  relationships:
    - keyword: Virus
      synergizes_with:
        - component: DealDamage
          effect: "Increases damage"
        - component: DrawCards
          effect: "Increases card draw"
    
    - keyword: ICE
      synergizes_with:
        - component: PreventDamage
          effect: "Increases damage prevention"
        - component: CancelCard
          effect: "Can be targeted by ICE Breaker cards"
    
    - keyword: Stealth
      synergizes_with:
        - component: DiscardCards
          effect: "Increases discard effect"
        - component: CancelCard
          effect: "Can bypass certain restrictions"
    
    - keyword: Cyberware
      synergizes_with:
        - component: CopyCard
          effect: "Enables copying from discard"
        - component: DrawCards
          effect: "Can enhance card drawing"